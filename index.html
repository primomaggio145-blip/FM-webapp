<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Accademia Musicale</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    html,body,#root{height:100%;width:100%}
    body{background:#0f0e0c}
    #loading{position:fixed;inset:0;background:#0f0e0c;display:flex;flex-direction:column;
      align-items:center;justify-content:center;gap:16px;z-index:9999;font-family:monospace;padding:24px}
    .logo{font-size:22px;font-weight:600;color:#c9a84c;font-family:sans-serif}
    .spinner{width:32px;height:32px;border:2px solid #2a2520;border-top-color:#c9a84c;
      border-radius:50%;animation:spin 0.8s linear infinite}
    .sub{font-size:11px;color:#4a4438;letter-spacing:0.1em;text-transform:uppercase;font-family:sans-serif}
    .err{color:#f87171;font-size:13px;background:#1a0d0d;padding:16px;border-radius:8px;
      max-width:90vw;width:100%;word-break:break-all;white-space:pre-wrap;max-height:60vh;overflow:auto}
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <div id="loading">
    <div class="logo">♪ Accademia Musicale</div>
    <div class="spinner" id="spinner"></div>
    <div class="sub" id="status">Caricamento app.js...</div>
  </div>
  <div id="root"></div>

  <script>
    // Catch ANY uncaught error globally
    window.onerror = function(msg, src, line, col, err) {
      document.getElementById('spinner').style.display = 'none';
      document.getElementById('status').style.display = 'none';
      var d = document.createElement('div');
      d.className = 'err';
      d.textContent = 'JS ERROR:\n' + msg + '\nLine: ' + line + '\nCol: ' + col + '\nFile: ' + src;
      document.getElementById('loading').appendChild(d);
    };
    window.onunhandledrejection = function(e) {
      document.getElementById('spinner').style.display = 'none';
      var d = document.createElement('div');
      d.className = 'err';
      d.textContent = 'Promise error: ' + (e.reason?.message || e.reason);
      document.getElementById('loading').appendChild(d);
    };
  </script>

  <script src="./app.js" onerror="document.getElementById('status').textContent='ERRORE: app.js non trovato (404). Carica il file su GitHub!'"></script>

  <script>
    (function() {
      document.getElementById('status').textContent = 'Avvio React...';
      var rootEl = document.getElementById('root');
      var loadingEl = document.getElementById('loading');
      try {
        // Check for boot error from the wrapped try-catch in app.js
        if (window.__BOOT_ERROR) throw window.__BOOT_ERROR;
        var AppComponent = window.__AppComponent;
        if (!AppComponent) throw new Error('App non trovato - app.js caricato ma App non definita');
        var root = ReactDOM.createRoot(rootEl);
        root.render(React.createElement(AppComponent));
        loadingEl.style.opacity = '0';
        loadingEl.style.transition = 'opacity 0.4s';
        setTimeout(function() { loadingEl.style.display = 'none'; }, 450);
      } catch(err) {
        document.getElementById('spinner').style.display = 'none';
        document.getElementById('status').textContent = '⚠️ Errore avvio';
        var d = document.createElement('div');
        d.className = 'err';
        d.textContent = 'ERRORE:\n' + (err.stack || err.message || String(err));
        loadingEl.appendChild(d);
      }
    })();
  </script>
</body>
</html>